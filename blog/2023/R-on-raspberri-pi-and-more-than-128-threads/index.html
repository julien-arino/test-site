<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="zrOU6pP7sLlXf7f0kW-NZRV1lZtdpybCfrJ3BeBMHQM"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Compiling R on a Raspberry Pi and getting rid of the 128 threads limitation | Julien Arino</title> <meta name="author" content="Julien Arino"> <meta name="description" content="Some considerations on compiling R on a Raspberry Pi to get rid of the 128 threads limitation"> <meta name="keywords" content="mathematical-epidemiology, mathematical-biology"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://julien-arino.github.io/blog/2023/R-on-raspberri-pi-and-more-than-128-threads/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <meta name="generator" content="Jekyll v4.4.1"> <meta property="og:title" content="Compiling R on a Raspberry Pi and getting rid of the 128 threads limitation"> <meta property="og:locale" content="en"> <meta name="description" content="Some considerations on compiling R on a Raspberry Pi to get rid of the 128 threads limitation"> <meta property="og:description" content="Some considerations on compiling R on a Raspberry Pi to get rid of the 128 threads limitation"> <link rel="canonical" href="https://julien-arino.github.io/blog/2023/R-on-raspberri-pi-and-more-than-128-threads/"> <meta property="og:url" content="https://julien-arino.github.io/blog/2023/R-on-raspberri-pi-and-more-than-128-threads/"> <meta property="og:site_name" content="blank"> <meta property="og:type" content="article"> <meta property="article:published_time" content="2023-02-05T00:00:00+00:00"> <meta name="twitter:card" content="summary"> <meta property="twitter:title" content="Compiling R on a Raspberry Pi and getting rid of the 128 threads limitation"> <meta name="google-site-verification" content="zrOU6pP7sLlXf7f0kW-NZRV1lZtdpybCfrJ3BeBMHQM"> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-05T00:00:00+00:00","datePublished":"2023-02-05T00:00:00+00:00","description":"Some considerations on compiling R on a Raspberry Pi to get rid of the 128 threads limitation","headline":"Compiling R on a Raspberry Pi and getting rid of the 128 threads limitation","mainEntityOfPage":{"@type":"WebPage","@id":"https://julien-arino.github.io/blog/2023/R-on-raspberri-pi-and-more-than-128-threads/"},"url":"https://julien-arino.github.io/blog/2023/R-on-raspberri-pi-and-more-than-128-threads/"}</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Julien </span>Arino</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/students/">students</a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Compiling R on a Raspberry Pi and getting rid of the 128 threads limitation</h1> <p class="post-meta">February 5, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/category/r-code"> <i class="fas fa-tag fa-sm"></i> r-code</a>   </p> </header> <article class="post-content"> <p>Does that title sound confusing? It should! Clearly, a 4 threaded Raspberry Pi should not hit that annoying “feature” baked in <code class="language-plaintext highlighter-rouge">R</code> whereby the number of sockets is limited to 125+3. Except that yes, it can, when the Pi used as the head node on a cluster.</p> <h2 id="the-context">The context</h2> <p>As part of work on COVID-19 response, I was awarded a contract to increase my capacity for at home computing. Of course, some work was still carried out in a proper HPC setting, but there is a benefit to being able to run mid-range stuff efficiently as well as prototype and debug stuff before sending it to some HPC resource. So in March and April 2020, I ordered and built four machines. Actually, make that five: four “proper” machines and a Pi to rule them all. All the pieces required 47 different deliveries and got me on a first name basis with several UPS and Amazon delivery people. After several exchanges, my setup has looked essentially like this:</p> <ul> <li>1 Raspberry Pi 4 with 4 GB of RAM running Ubuntu.</li> <li>3 Threadripper 3790X machines running Ubuntu, each with 128 GB RAM and a 500 GB NVMe M.2 HD.</li> <li>1 Threadripper 3990X machine running Ubuntu with 192 GB RAM (and also a 500 GB HD).</li> <li>1 NAS with 4 TB storage.</li> <li>1 swicth connecting all that can (i.e., all but the Pi) using link bonding and the Pi using a single link.</li> </ul> <p>The 3790X have 32 cores/64 threads, the 3990X has 64/128. So my little space heater (hydro bills have been impacted substantially when all the machines run concurrently) has 320 compute threads and 4 on the Pi.</p> <h2 id="my-original-usage">My original usage</h2> <p>With some tweaking of the BIOS, I gently overclocked the Threadrippers (the 3990X, in particular, is a little sluggish for the type of computations I run) and convinced the motherboards to recognise all the RAM at its posted speed. I started using in production right away, which means I did not bother with my configuration and kept things as simple as possible.</p> <p>This is when I hit the “125+3 sockets in <code class="language-plaintext highlighter-rouge">R</code>” issue the first time: my code was running fine on the 3970X but refusing to run on the 3990X. Dug into it and worked out that setting the number of CPUs to 125 in my calls to <code class="language-plaintext highlighter-rouge">makeCluster</code> on the 3990X did the trick. With 4 perfectly capable compute nodes and easily parallelisable tasks, it is easy enough to produce a job list and have the Pi distribute it between nodes, have the nodes save the results locally upon completion and have the Pi running periodic “<code class="language-plaintext highlighter-rouge">rsync</code> repatriations” of the results from the nodes to the NAS. Once the computations were done, I used one of the compute nodes to bring the pieces together.</p> <h2 id="compiling-r-to-remove-the-1253-sockets-limitation">Compiling <code class="language-plaintext highlighter-rouge">R</code> to remove the 125+3 sockets limitation</h2> <p>Besides using <strong>all</strong> threads on the 3990X, I am also keen to drive all computations from a single designated node (when warranted, of course). I have been meaning to do this for quite a while, but this was rather low on my priority list. (I also want to play around with solutions such as <code class="language-plaintext highlighter-rouge">slurm</code> or <code class="language-plaintext highlighter-rouge">htcondor</code>, but this will be for later.) And here, the 125+3 sockets pops up again: as far as I understand it, the head node needs as many sockets as threads it is talking to, i.e., 320 in my case.</p> <p>I have an old refurbished Dell Precision T7600 with two 8 cores E5-2690 Xeons and 128 GB of RAM that can be the head node. But what is the fun in that when I also have a Pi to play with? So, now that I have a bit more time, I decided to bite the bullet and try things out.</p> <p>First step, remove the 128 sockets limitation. Extremely easy: just compile <code class="language-plaintext highlighter-rouge">R</code> from sources. Which was deceptively easy, even on the Pi. This should not have been a surprise for someone coming from the days of yore when Linux did not have <code class="language-plaintext highlighter-rouge">deb</code> or <code class="language-plaintext highlighter-rouge">rpm</code> and every program installation required compilation. I took some inspiration <a href="https://www.psyctc.org/Rblog/posts/2021-03-26-compiling-r-on-a-raspberry-pi-4/" rel="external nofollow noopener" target="_blank">here</a>, but will point out that I had virtually none of the steps described there to follow, as I had had to install most of the software required for compilations prior to that.</p> <p>The process is easy. Download the <code class="language-plaintext highlighter-rouge">R</code> source code from <a href="https://cran.r-project.org/sources.html" rel="external nofollow noopener" target="_blank">here</a>. (I used the <a href="https://stat.ethz.ch/R/daily/R-patched.tar.gz" rel="external nofollow noopener" target="_blank">patched release</a>.) Extract the tarball and move into the resulting directory. See some information <a href="https://parallelly.futureverse.org/reference/availableConnections.html" rel="external nofollow noopener" target="_blank">here</a> about setting the maximum allowed number of connections, but in short: edit the file <code class="language-plaintext highlighter-rouge">src/main/connections.c</code> and replace</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define NCONNECTIONS 128
</span></code></pre></div></div> <p>with whatever limit you want to impose. There is some discussion <a href="https://github.com/HenrikBengtsson/Wishlist-for-R/issues/28" rel="external nofollow noopener" target="_blank">here</a> on potential issues related to the number chosen; completely ignoring these issues, I decided to pick 1024.</p> <p>Then <code class="language-plaintext highlighter-rouge">configure</code>, <code class="language-plaintext highlighter-rouge">make</code> (<code class="language-plaintext highlighter-rouge">make -j4</code>, perhaps) and <code class="language-plaintext highlighter-rouge">sudo make install</code> and you are in business. One remark, though: I prefer for the <code class="language-plaintext highlighter-rouge">R</code> executables and libraries to reside in <code class="language-plaintext highlighter-rouge">/usr</code> rather than <code class="language-plaintext highlighter-rouge">/usr/local</code> (for consistency with <code class="language-plaintext highlighter-rouge">deb</code> install of the standard code). Also, if you are going to run <code class="language-plaintext highlighter-rouge">rstudio-server</code>, you <strong>must</strong> compile for a shared <code class="language-plaintext highlighter-rouge">R</code> library. So, in short, instead of a simple <code class="language-plaintext highlighter-rouge">./configure</code>, I ran</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--enable-R-shlib</span>
</code></pre></div></div> <p>That latter point is worth mentioning: yes, <code class="language-plaintext highlighter-rouge">rstudio-server</code> on a Pi! I just recently realised that although the main <code class="language-plaintext highlighter-rouge">rstudio-server</code> site does not list it, <code class="language-plaintext highlighter-rouge">rstudio</code> and <code class="language-plaintext highlighter-rouge">rstudio-server</code> are available for <code class="language-plaintext highlighter-rouge">arm64</code> as <a href="https://dailies.rstudio.com/" rel="external nofollow noopener" target="_blank">daily builds</a>. And that <code class="language-plaintext highlighter-rouge">R</code> shared lib is important in this context: <code class="language-plaintext highlighter-rouge">rstudio-server</code> will not work otherwise.</p> <h2 id="taking-it-for-a-spin">Taking it for a spin</h2> <p>Simple call to check things are working. Run the following code, adapting to your setup. (Note that this implies you have set up your machines to use shared key <code class="language-plaintext highlighter-rouge">ssh</code>.) Note that in the code here, I have not yet used the adapted version of <code class="language-plaintext highlighter-rouge">R</code> on the 3990X, so I am limiting things to 125 threads there.</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">node0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'192.168.0.50'</span><span class="w">
</span><span class="n">node1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'192.168.0.51'</span><span class="w">
</span><span class="n">node2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'192.168.0.52'</span><span class="w">
</span><span class="n">node3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'192.168.0.53'</span><span class="w">
</span><span class="n">node4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'192.168.0.54'</span><span class="w">
</span><span class="n">machineAddresses</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w">
  </span><span class="nf">list</span><span class="p">(</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node0</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'jarino'</span><span class="p">,</span><span class="w"> </span><span class="n">ncore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w">
  </span><span class="nf">list</span><span class="p">(</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node1</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'jarino'</span><span class="p">,</span><span class="w"> </span><span class="n">ncore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">64</span><span class="p">),</span><span class="w">
  </span><span class="nf">list</span><span class="p">(</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node2</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'jarino'</span><span class="p">,</span><span class="w"> </span><span class="n">ncore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">64</span><span class="p">),</span><span class="w">
  </span><span class="nf">list</span><span class="p">(</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node3</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'jarino'</span><span class="p">,</span><span class="w"> </span><span class="n">ncore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">64</span><span class="p">),</span><span class="w">
  </span><span class="nf">list</span><span class="p">(</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node4</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'jarino'</span><span class="p">,</span><span class="w"> </span><span class="n">ncore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">125</span><span class="p">)</span><span class="w">
</span><span class="p">)</span><span class="w">
</span><span class="n">spec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="n">machineAddresses</span><span class="p">,</span><span class="w">
               </span><span class="k">function</span><span class="p">(</span><span class="n">machine</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                 </span><span class="nf">rep</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">machine</span><span class="o">$</span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="o">=</span><span class="n">machine</span><span class="o">$</span><span class="n">user</span><span class="p">)),</span><span class="w">
                     </span><span class="n">machine</span><span class="o">$</span><span class="n">ncore</span><span class="p">)</span><span class="w">
               </span><span class="p">})</span><span class="w">
</span><span class="n">spec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unlist</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span><span class="w"> </span><span class="n">recursive</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">parallelCluster</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">parallel</span><span class="o">::</span><span class="n">makeCluster</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'PSOCK'</span><span class="p">,</span><span class="w">
                                         </span><span class="n">master</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node0</span><span class="p">,</span><span class="w">
                                         </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spec</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">parallelCluster</span><span class="p">)</span><span class="w">
</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">parallelCluster</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">parallel</span><span class="o">::</span><span class="n">stopCluster</span><span class="p">(</span><span class="n">parallelCluster</span><span class="p">)</span><span class="w">
  </span><span class="n">parallelCluster</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="p">}</span></code></pre></figure> <p>Then, calling <code class="language-plaintext highlighter-rouge">test_cluster.R</code> this code and running it from the command line,</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jarino@node0:~/CODE<span class="nv">$ </span>Rscript test_cluster.R 
socket cluster with 319 nodes on hosts ‘192.168.0.50’, ‘192.168.0.51’, ‘192.168.0.52’, ‘192.168.0.53’, ‘192.168.0.54’
</code></pre></div></div> <p>So we are good! For comparison, running from a node with a “standard” <code class="language-plaintext highlighter-rouge">R</code> without the number of sockets increased (modifying the head node to be <code class="language-plaintext highlighter-rouge">node1</code>), we get the usual error:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jarino@node1:~/CODE<span class="nv">$ </span>Rscript test_cluster.R 
Error <span class="k">in </span>socketConnection<span class="o">(</span><span class="s2">"localhost"</span>, port <span class="o">=</span> port, server <span class="o">=</span> TRUE, blocking <span class="o">=</span> TRUE,  : 
  all connections are <span class="k">in </span>use
Calls: &lt;Anonymous&gt; ... makePSOCKcluster -&gt; newPSOCKnode -&gt; socketConnection
Execution halted
Error <span class="k">in </span>gzfile<span class="o">(</span>file, <span class="s2">"rb"</span><span class="o">)</span> : all connections are <span class="k">in </span>use
Calls: &lt;Anonymous&gt; -&gt; cleanup -&gt; loadNamespace -&gt; readRDS -&gt; gzfile
</code></pre></div></div> <p>Two final remarks.</p> <ol> <li>The call to <code class="language-plaintext highlighter-rouge">makeCluster</code> can be quite lengthy (several minutes), even in this simple case with no functions or libraries to declare to the workers, so it is important to decide whether this level of parallelisation is required; if not, things may run much faster on 4 separate computers with result agregation as described earlier.</li> <li>Clearly, this setup will require, in most instances, to have the code running on the compute nodes store the result locally there rather than return results to the head node. Indeed, only small sized return values would not quickly overwhelm the Pi’s small RAM.</li> </ol> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Julien Arino. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: February 02, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-97QKRGST95"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-97QKRGST95");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>