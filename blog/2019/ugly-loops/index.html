<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="zrOU6pP7sLlXf7f0kW-NZRV1lZtdpybCfrJ3BeBMHQM"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Ugly loops versus pretty vectors | Julien Arino</title> <meta name="author" content="Julien Arino"> <meta name="description" content="A comparison of the execution times of loops and vector operations in R using the tictoc library."> <meta name="keywords" content="mathematical-epidemiology, mathematical-biology"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://julien-arino.github.io/blog/2019/ugly-loops/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <meta name="generator" content="Jekyll v4.4.1"> <meta property="og:title" content="Ugly loops versus pretty vectors"> <meta property="og:locale" content="en"> <meta name="description" content="A comparison of the execution times of loops and vector operations in R using the tictoc library."> <meta property="og:description" content="A comparison of the execution times of loops and vector operations in R using the tictoc library."> <link rel="canonical" href="https://julien-arino.github.io/blog/2019/ugly-loops/"> <meta property="og:url" content="https://julien-arino.github.io/blog/2019/ugly-loops/"> <meta property="og:site_name" content="blank"> <meta property="og:type" content="article"> <meta property="article:published_time" content="2019-07-10T00:00:00+00:00"> <meta name="twitter:card" content="summary"> <meta property="twitter:title" content="Ugly loops versus pretty vectors"> <meta name="google-site-verification" content="zrOU6pP7sLlXf7f0kW-NZRV1lZtdpybCfrJ3BeBMHQM"> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-07-10T00:00:00+00:00","datePublished":"2019-07-10T00:00:00+00:00","description":"A comparison of the execution times of loops and vector operations in R using the tictoc library.","headline":"Ugly loops versus pretty vectors","mainEntityOfPage":{"@type":"WebPage","@id":"https://julien-arino.github.io/blog/2019/ugly-loops/"},"url":"https://julien-arino.github.io/blog/2019/ugly-loops/"}</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Julien </span>Arino</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/students/">students</a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Ugly loops versus pretty vectors</h1> <p class="post-meta">July 10, 2019</p> <p class="post-tags"> <a href="/blog/2019"> <i class="fas fa-calendar fa-sm"></i> 2019 </a>   ·   <a href="/blog/category/simulation"> <i class="fas fa-tag fa-sm"></i> simulation</a>   <a href="/blog/category/r-code"> <i class="fas fa-tag fa-sm"></i> r-code</a>   </p> </header> <article class="post-content"> <p>The other day, I posted a prototypical example of use of parLapply, somewhat more advanced than the ones in the documentation; see <a href="https://julien-arino.github.io/blog/2019/skel-parLapply">here</a>.</p> <p>Well, part of the example I gave uses one of my most biggest coding pet peaves, something that I have been fighting against ever since my MatLab days: the dreaded unnecessary <em>for loop</em>. As I was teaching myself the use of the <code class="language-plaintext highlighter-rouge">tictoc</code> library, I thought I would illustrate both.</p> <p>To keep in the spirit of the example in the post mentioned, we set up variations of up to two parameters, \(\beta\) and \(S_0\). We set base values for these parameters.</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">param</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
</span><span class="n">param</span><span class="o">$</span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-6</span><span class="w">
</span><span class="n">param</span><span class="o">$</span><span class="n">S0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10000</span></code></pre></figure> <p>We will try different ranges of number of cases.</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">nb_sims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">10000</span><span class="p">,</span><span class="m">50000</span><span class="p">,</span><span class="m">100000</span><span class="p">,</span><span class="m">500000</span><span class="p">,</span><span class="m">1000000</span><span class="p">,</span><span class="m">5000000</span><span class="p">,</span><span class="m">10000000</span><span class="p">)</span></code></pre></figure> <p>Now loop on the number of cases. First, clear the <code class="language-plaintext highlighter-rouge">tictoc</code> log, in case it already exists. In each loop, we take note of the time taken to accomplish each group of operations.</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">tictoc</span><span class="o">::</span><span class="n">tic.clearlog</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">nb_sims</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># Just for info in case things get longish</span><span class="w">
  </span><span class="n">print</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s2">"%d - %d"</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">which</span><span class="p">(</span><span class="n">nb_sims</span><span class="o">==</span><span class="n">n</span><span class="p">)))</span><span class="w">
  </span><span class="c1"># The loop version</span><span class="w">
  </span><span class="n">tictoc</span><span class="o">::</span><span class="n">tic</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s2">"loop_%d"</span><span class="p">,</span><span class="n">n</span><span class="p">))</span><span class="w">
  </span><span class="n">param_vary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">param_vary</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
    </span><span class="n">param_vary</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-9</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-4</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="m">+1</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">param_vary</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
    </span><span class="n">param_vary</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">S0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100000</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="n">n</span><span class="m">+1</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="m">3</span><span class="o">*</span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">param_vary</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
    </span><span class="n">param_vary</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-9</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-4</span><span class="p">)</span><span class="w">
    </span><span class="n">param_vary</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">S0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100000</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="c1"># Vector version</span><span class="w">
  </span><span class="n">tictoc</span><span class="o">::</span><span class="n">toc</span><span class="p">(</span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="n">tictoc</span><span class="o">::</span><span class="n">tic</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s2">"vect_%d"</span><span class="p">,</span><span class="n">n</span><span class="p">))</span><span class="w">
  </span><span class="n">param_vary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">cbind</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-9</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-4</span><span class="p">),</span><span class="w">
                            </span><span class="nf">rep</span><span class="p">(</span><span class="n">param</span><span class="o">$</span><span class="n">S0</span><span class="p">,</span><span class="n">n</span><span class="p">)),</span><span class="w">
                      </span><span class="n">cbind</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="n">param</span><span class="o">$</span><span class="n">beta</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w">
                            </span><span class="n">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100000</span><span class="p">)),</span><span class="w">
                      </span><span class="n">cbind</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-9</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e-4</span><span class="p">),</span><span class="w">
                            </span><span class="n">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100000</span><span class="p">)))</span><span class="w">
  </span><span class="n">colnames</span><span class="p">(</span><span class="n">param_vary</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"beta"</span><span class="p">,</span><span class="s2">"S0"</span><span class="p">)</span><span class="w">
  </span><span class="n">tictoc</span><span class="o">::</span><span class="n">toc</span><span class="p">(</span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="c1"># Convert vector to list</span><span class="w">
  </span><span class="n">tictoc</span><span class="o">::</span><span class="n">tic</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s2">"conv_%d"</span><span class="p">,</span><span class="n">n</span><span class="p">))</span><span class="w">
  </span><span class="n">param_vary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="nf">seq_len</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">param_vary</span><span class="p">)),</span><span class="w">
                       </span><span class="k">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">param_vary</span><span class="p">[</span><span class="n">i</span><span class="p">,])</span><span class="w">
  </span><span class="n">tictoc</span><span class="o">::</span><span class="n">toc</span><span class="p">(</span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">log.lst</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tictoc</span><span class="o">::</span><span class="n">tic.log</span><span class="p">(</span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span></code></pre></figure> <p>The following is adapted from the <code class="language-plaintext highlighter-rouge">tictoc</code> documentation.</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">timings</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">nb_sims</span><span class="p">,</span><span class="w">
                 </span><span class="n">matrix</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unlist</span><span class="p">(</span><span class="n">lapply</span><span class="p">(</span><span class="n">log.lst</span><span class="p">,</span><span class="w">
                                             </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">toc</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">tic</span><span class="p">)),</span><span class="w">
                        </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">nb_sims</span><span class="p">),</span><span class="w">
                        </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w">
                        </span><span class="n">byrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">timings</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"n"</span><span class="p">,</span><span class="s2">"loopT"</span><span class="p">,</span><span class="s2">"vectT"</span><span class="p">,</span><span class="s2">"convT"</span><span class="p">)</span><span class="w">
</span><span class="n">timings</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">timings</span><span class="p">)</span></code></pre></figure> <p>Add a few additional pieces of information about timing: the total time in the second case (making the vectors and converting them to lists) as well as acceleration factors when making the vector and in total of the second method.</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">timings</span><span class="o">$</span><span class="n">sumVect</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">timings</span><span class="o">$</span><span class="n">vectT</span><span class="o">+</span><span class="n">timings</span><span class="o">$</span><span class="n">convT</span><span class="w">
</span><span class="n">timings</span><span class="o">$</span><span class="n">multVect</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">timings</span><span class="o">$</span><span class="n">loopT</span><span class="o">/</span><span class="n">timings</span><span class="o">$</span><span class="n">vectT</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">timings</span><span class="o">$</span><span class="n">multSVect</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">timings</span><span class="o">$</span><span class="n">loopT</span><span class="o">/</span><span class="n">timings</span><span class="o">$</span><span class="n">sumVect</span><span class="p">,</span><span class="m">2</span><span class="p">)</span></code></pre></figure> <p>Finally, use <code class="language-plaintext highlighter-rouge">knitr</code> to make a decent looking table of the results.</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">knitr</span><span class="o">::</span><span class="n">kable</span><span class="p">(</span><span class="n">timings</span><span class="p">,</span><span class="n">format.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">big.mark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">","</span><span class="p">,</span><span class="n">scientific</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">))</span></code></pre></figure> <p>Here are the results:</p> <table> <thead> <tr> <th style="text-align: right">n</th> <th style="text-align: right">loopT</th> <th style="text-align: right">vectT</th> <th style="text-align: right">convT</th> <th style="text-align: right">sumVect</th> <th style="text-align: right">multVect</th> <th style="text-align: right">multSVect</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">10,000</td> <td style="text-align: right">0.138</td> <td style="text-align: right">0.001</td> <td style="text-align: right">0.046</td> <td style="text-align: right">0.047</td> <td style="text-align: right">138.00</td> <td style="text-align: right">2.94</td> </tr> <tr> <td style="text-align: right">50,000</td> <td style="text-align: right">0.545</td> <td style="text-align: right">0.006</td> <td style="text-align: right">0.327</td> <td style="text-align: right">0.333</td> <td style="text-align: right">90.83</td> <td style="text-align: right">1.64</td> </tr> <tr> <td style="text-align: right">100,000</td> <td style="text-align: right">1.207</td> <td style="text-align: right">0.008</td> <td style="text-align: right">0.346</td> <td style="text-align: right">0.354</td> <td style="text-align: right">150.88</td> <td style="text-align: right">3.41</td> </tr> <tr> <td style="text-align: right">500,000</td> <td style="text-align: right">8.587</td> <td style="text-align: right">0.453</td> <td style="text-align: right">1.712</td> <td style="text-align: right">2.165</td> <td style="text-align: right">18.96</td> <td style="text-align: right">3.97</td> </tr> <tr> <td style="text-align: right">1,000,000</td> <td style="text-align: right">19.130</td> <td style="text-align: right">1.597</td> <td style="text-align: right">3.832</td> <td style="text-align: right">5.429</td> <td style="text-align: right">11.98</td> <td style="text-align: right">3.52</td> </tr> <tr> <td style="text-align: right">5,000,000</td> <td style="text-align: right">122.943</td> <td style="text-align: right">4.359</td> <td style="text-align: right">22.746</td> <td style="text-align: right">27.105</td> <td style="text-align: right">28.20</td> <td style="text-align: right">4.54</td> </tr> <tr> <td style="text-align: right">10,000,000</td> <td style="text-align: right">277.161</td> <td style="text-align: right">8.648</td> <td style="text-align: right">40.261</td> <td style="text-align: right">48.909</td> <td style="text-align: right">32.05</td> <td style="text-align: right">5.67</td> </tr> </tbody> </table> <p>Clearly, it would be better here to use a parallel version of <code class="language-plaintext highlighter-rouge">apply</code> operating on matrix rows than on lists, since this would not require a further conversion to a list. But the cases are not always this structured.</p> <p>Ah, yes, one last thing: when \(n\) is large, some of the variables can become quite large (the last matrix by itself is 10.1 Gb). Unless you have pretty decent RAM, don’t try this at home.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Julien Arino. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: February 02, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-97QKRGST95"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-97QKRGST95");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>